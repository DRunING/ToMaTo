<Directory /code>
    Require all granted
</Directory>

WSGIPythonOptimize 1

<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    DocumentRoot /code/tomato/web

    RewriteEngine On
    RewriteCond %{ENV:REDIRECT_STATUS} !=503
    RewriteCond "/config/web.maintenance" -f
    RewriteRule ^(.*)$ /$1 [R=503,L]
    
    Alias /icons /code/tomato/web/icons
    Alias /static /code/tomato/web/static
    Alias /style /code/tomato/web/style
    Alias /img /code/tomato/web/img
    Alias /js /code/tomato/web/js
    Alias /fonts /code/tomato/web/fonts
    Alias /editor_tutorial /code/tomato/web/editor_tutorial
    
    WSGIScriptAlias / /code/web/django.wsgi
</VirtualHost>

<VirtualHost *:443>
    ServerAdmin webmaster@localhost

    SSLEngine on
    SSLCertificateFile    /config/web.pem
    SSLCertificateKeyFile /config/web.pem
    
    DocumentRoot /code/tomato/web

    RewriteEngine On
    RewriteCond %{ENV:REDIRECT_STATUS} !=503
    RewriteCond "/config/web.maintenance" -f
    RewriteRule ^(.*)$ /$1 [R=503,L]
    
    Alias /icons /code/tomato/web/icons
    Alias /static /code/tomato/web/static
    Alias /style /code/tomato/web/style
    Alias /img /code/tomato/web/img
    Alias /js /code/tomato/web/js
    Alias /fonts /code/tomato/web/fonts
    Alias /editor_tutorial /code/tomato/web/editor_tutorial
    
    WSGIScriptAlias / /code/web/django.wsgi
</VirtualHost>
