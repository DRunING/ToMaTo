{% extends "admin/base.html" %}

{% load tomato %}

{% block content %}
<h1>Account List</h1>

<script src="/js/enhancetable.js"></script>
<table class="sortable,filterable table table-striped">
  <tr>
    <th>Name</th>
    <th>Origin</th>
    <th>Organization</th>
    <th>Full name</th>
    <th>Affiliation</th>
    
    {% if show_flags %}
    	<th>Flags</th>
    {% endif %}
    
    {% if show_reason %}
    	<th>Reason for Registering</th>
    {% endif %}
    
    
	{% if "global_admin" in request.session.user.flags or "orga_admin" in request.session.user.flags %}
	    <th></th>
	{% endif %}
  </tr>
{% for account in accounts %}
  <tr>
    <td>{{account.name}}</td>
    <td>{{account.origin}}</td>
    <td>{{account.organization}}</td>
    <td>{{account.realname}}</td>
    <td>{{account.affiliation}}</td>    
    
    {% if show_flags %}
	    <td>
	    	<div class="hoverdescription">
	    		{{account.flags|join:", "}}
	    		<div class="hiddenbox">
	    			{% for f in account.flags_name %}
	    				<p>
	    					{{f}}
	    				</p>
	    			{% endfor %}
	    		</div>
	    	</div>
	    </td>
	{% endif %}
	    
	{% if show_reason %}
	    <td>
	    	{% if account.reason %}
		    	<div class="hoverdescription">
		    		<img src="/img/info.png" />
		    		<div class="hiddenbox">
		    			{{ account.reason|linebreaks|escape|simpletags:"b i em strong"|safe }}
		    		</div>
		    	</div>
		    {% endif %}
	    </td>
	{% endif %}
	    
	{% if request.session.user|args:account.organization|call:"isAdmin" %}
	    <td>
	      <a href="{%url account.info account.id %}"><img src="/img/pencil.png" title="edit" /></a> <a href="{%url account.remove account.id %}"><img src="/img/cross.png" title="remove" /></a>
	    </td>
	{% endif %}
  </tr>
{% endfor %}
</table>

{% endblock %}