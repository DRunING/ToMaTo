{% extends "admin/base.html" %}

{% load tomato %}

{% block content %}
<h1>List of Sites</h1>

{% if site_list %}

	{% if site_list|length > 10 and user and user.isAdmin %}
		<p><input type="button" onClick="window.location='{%url site.add%}'" value="Add site" /></p>
	{% endif %}

	<script src="/js/enhancetable.js"></script>
	
	
	<table class="sortable,filterable">
	  <tr>
	    <th>Name</th>
	    <th>Label</th>
	    <th>Location</th>
	    <th>Organization</th>
	    <th>Description</th>
	    
	    {% if user.isAdmin or "orga_admin" in user.flags %}
	    	<th />
	    {% endif %}
	    
	  </tr>
	  
	{% for site in site_list %}
	  <tr>
	    <td>{{site.name}}</td>
	    <td>{{site.description}}</td>
	    <td>{{site.location}}</td>
	    <td>{{site.organization}}</td>
	    
	    <td>{% if site.description_text %}
		<div class="hoverdescription">
			<img src="/img/info.png" alt="i" />
			<div class="hiddenbox">
				{{ site.description_text|linebreaks|escape|simpletags:"b i em strong"|safe }}
			</div>
		</div>
		{%endif%}</td>
	    
	    {% if user and user|args:site.organization|call:"isAdmin" %}
	    	<td>
	    		<a href="{%url site.edit site.name%}"><img src="/img/pencil.png" title="edit" /></a>
	    		&nbsp;
	    		<a href="{%url site.remove site.name%}" ><img src="/img/cross.png" title="remove" /></a>
			</td>
	    {% endif %}
	    
	  </tr>
	{% endfor %}
	
	</table>
{% else %}
	No sites
{% endif %}

{% if user and user.isAdmin %}
	<p><input type="button" onClick="window.location='{%url site.add%}'" value="Add site" /></p>
{% endif %}

{% endblock %}
